---
title: "The illusory promise of the Aligned Rank Transform"
subtitle: "Appendix I. Mathematical explanations and proofs"
author: 
  - name: Theophanis Tsandilas
    orcid: 0000-0002-0158-228X
    email: theophanis.tsandilas@inria.fr
    affiliations:
      - name: Université Paris-Saclay, CNRS, Inria, LISN
        country: France
  - name: Géry Casiez
    orcid: 0000-0003-1905-815X
    email: gery.casiezuniv-lille.fr
    affiliations:
      - name: Univ. Lille, CNRS, Inria, Centrale Lille, UMR 9189 CRIStAL
        country: France
bibliography: bibliography.bib
csl: canadian-journal-of-philosophy.csl

tbl-cap-location: top
---

## Comparing Type I error rates under non-linear models
Consider again the general relationship between the expected value of a response variable $Y$, which may follow a non-normal distribution, and the predictors in an experimental design with two independent variables $x_1$ and $x_2$:  

$$
E(Y|x_1, x_2) = g^{-1}(a_0 + a_1 x_1 + a_2 x_2 + a_{12}x_1 x_2)
$$
where $g^{-1}$ is the inverse link function.

We show that, in the main scenarios considered in this article, the interpretation of effects is not affected by whether the null hypothesis is defined on the coefficient scale or on the response-mean scale. Our analysis follows related discussions in @Ai:2003, @Greene:2010, and @McCabe:2022.

For clarity, let
$$
\eta(x_1, x_2) = a_0 + a_1 x_1 + a_2 x_2 + a_{12}x_1 x_2
$$
denote the linear predictor, and
$$
\mu(x_1, x_2) = E(Y|x_1, x_2) = g^{-1}(\eta(x_1, x_2))
$$
denote the expected value (or mean) as a function of $x_1$ and $x_2$.

### Main effects
We first show that there is no ambiguity in the interpretation of main effects when $a_{12}=0$. 

Without loss of generality, assume that $a_1 \neq 0$ an examine the effect on the second factor $x_2$ when $a_2 = 0$. In that case,
$$
\begin{aligned}
\eta(x_1, x_2) = a_0 + a_1 x_1, \qquad
\mu(x_1, x_2) = g^{-1}(a_0 + a_1 x_1)
\end{aligned}
$$
so $\mu$ is a function of $x_1$ only.

We consider two situations:

**(a) Continuous $x_2$: effect defined by a partial derivative**

The effect of $x_2$ on the response can be defined as $\frac{\partial \mu}{\partial x_2}$. Because the argument of $g^{-1}$ contains no $x_2$:
$$\frac{\partial \mu(x_1, x_2)}{\partial x_2}  = \frac{\partial}{\partial x_2} g^{-1}(a_0 + a_1 x_1) = 0$$
Thus, $x_2$ has no effect on the mean response.  

**(b) Categorical $x_2$: effect defined by contrasts**

This is the setting relevant to our simulations. Let $L_2$ denote the levels of $x_2$. For any two levels $u, \nu \in L_2$, the contrast is:
$$\Delta_{u,\upsilon}\mu(x_1, x_2) = \mu(x_1, u) - \mu(x_1, \upsilon) = g^{-1}(a_0 + a_1 x_1) - g^{-1}(a_0 + a_1 x_1) = 0.$$

#### Conclusion (main effects)

If $a_{12} = 0$ and $a_2 = 0$, then $x_2$ has no effect on the mean of the responses. Thus, whether Type I error is defined in terms of the coefficient $a_2$ or in terms of the equality of observed means across levels of $x_2$ makes no difference.

This conclusion **is not limited to means**. If the distribution of $Y | (x_1, x_2)$ depends on $x_1$, $x_2$ only through the predictor $\eta(x_1, x_2)$ --- that is, if scale or shape parameters do not depend on the factors --- then no effect of $x_2$ can appear on the mean, the median, or any other quantile of the distribution whenever $a_{12}=0$ and $a_2=0$.

### Interactions
Similarly, we show that there is no ambiguity in the interpretation of interaction effects when either $a_1 = 0$ or $a_2 =0$. Without loss of generality, assume $a_2 = 0$ and $a_1 \neq 0$. When $a_{12}=0$, 
$$
\begin{aligned}
\eta(x_1, x_2) = a_0 + a_1 x_1, \qquad
\mu(x_1, x_2) = g^{-1}(a_0 + a_1 x_1)
\end{aligned}
$$

A common definition of interaction on the response scale [@Ai:2003] is that the marginal effect of $x_1$ depends on $x_2$. We examine two situations:

**(a) Continuous predictors: interaction defined by a cross-partial derivative.**

Assuming $g^{-1}$ is twice differentiable, an interaction is present if $\frac{\partial^2 \mu}{\partial x_2 \partial x_1} \neq 0$. 

We compute:
$$\frac{\partial \mu}{\partial x_1} = \dot{g}^{-1}(\eta) \cdot a_1$$

and 

$$\frac{\partial^2 \mu}{\partial x_2 \partial x_1} = \ddot{g}^{-1}(\eta) \cdot \frac{\partial \eta}{\partial x_2} \cdot a_1$$

But for our settings ($a_2=a_{12}=0$)

$$\frac{\partial \eta}{\partial x_2} = a_2 + a_{12}x_1 = 0$$

and therefore

$$\frac{\partial^2 \mu}{\partial x_2 \partial x_1} = 0$$

 Thus the marginal effect of $x_1$ does not vary with $x_2$, and there is no interaction.
  
**(b) Categorical predictors: interaction defined by double discrete differences** 

Let $L_1$ and $L_2$ be the levels of $x_1$ and $x_2$, respectively. The categorical analogue of a cross-partial derivative is the double difference:

$$\Delta_{u_1, \nu_1} \Delta_{u_2, \nu_2}\mu(x_1, x_2) = [\mu(u_1,u_2) - \mu(u_1, \nu_2)] - [\mu(\nu_1,u_2) - \mu(\nu_1, \nu_2)]$$

But when $a_2 = a_{12} = 0$, $\mu(u_1,u_2) = \mu(u_1,\nu_2)$ and $\mu(\nu_1,u_2) = \mu(\nu_1,\nu_2)$, so the double difference is always zero for any levels $u_1, \nu_1 \in L_1$ and $u_2, \nu_2 \in L_2$.  

#### Conclusion (interaction effects)

If either $a_1 = 0$ or $a_2 = 0$ and $a_{12} = 0$, then no interaction can be observed on the response scale. Thus Type I error definitions based on the coefficient $a_{12}$ or on observed interaction contrasts are equivalent in these settings.

## References {.unnumbered}

::: {#refs}
:::
